<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mother Habit Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ============================================
           PRIORITY 1: ENHANCED COLOR SYSTEM
           Matching mother-child image: warm cream, soft purple, light pink
           ============================================ */
        :root {
            /* Primary Brand Colors - Matching Image Palette */
            --primary-lavender-50: #F5F0FF;
            --primary-lavender-100: #E8DFF5;
            --primary-lavender-200: #D4C2E8;
            --primary-lavender-300: #B8A5D9;
            --primary-lavender-500: #9575CD;
            --primary-lavender-700: #7B5BA6;
            
            --soft-pink-50: #FFF0F5;
            --soft-pink-100: #FCE4EC;
            --soft-pink-200: #F9D5E5;
            --soft-pink-300: #F8BBD0;
            --soft-pink-500: #E8A4B8;
            --soft-pink-700: #D4869A;
            
            /* Image-matched colors */
            --warm-cream: #F5EDE4;
            --warm-cream-light: #FBF8F4;
            --warm-cream-dark: #EDE3D7;
            --sage-green: #E8F5E9;
            --soft-blue: #E3F2FD;
            
            /* Semantic Colors - Softer versions */
            --success-green: #7CB984;
            --success-green-light: #D4EDDA;
            --warning-orange: #E8B87D;
            --warning-orange-light: #FDECD0;
            --info-blue: #7EB0D5;
            --info-blue-light: #D0E8F5;
            
            /* Neutral System - NO BLACK/GREY - Using cream and lavender */
            --neutral-50: #FFFFFF;
            --neutral-100: #FBF8F4;
            --neutral-200: #F5F0FF;
            --neutral-300: #E8DFF5;
            --neutral-400: #D4C2E8;
            
            /* Text Hierarchy - Readable dark purples instead of black/grey */
            --text-primary: #4A3B5C;
            --text-secondary: #6B5A7D;
            --text-tertiary: #8E7DA0;
            --text-inverse: #FFFFFF;
            --text-dark: #3D2E4F;
            
            /* Glassmorphism Colors - Warmer */
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(149, 117, 205, 0.15);
            --glass-shadow: rgba(149, 117, 205, 0.1);
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, 
                var(--primary-lavender-100) 0%, 
                var(--soft-pink-100) 50%, 
                var(--warm-cream) 100%);
            
            --gradient-card: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%, 
                rgba(255, 255, 255, 0.85) 100%);
            
            --gradient-accent: linear-gradient(135deg, 
                var(--primary-lavender-500) 0%, 
                var(--soft-pink-500) 100%);
            
            --gradient-animated: linear-gradient(
                -45deg,
                var(--warm-cream),
                var(--primary-lavender-100),
                var(--soft-pink-100),
                var(--warm-cream-light)
            );
            --gradient-size: 400% 400%;
            
            /* Typography System - Fluid Scaling */
            --font-display: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            --font-body: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            
            --text-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
            --text-sm: clamp(0.875rem, 0.8rem + 0.375vw, 1rem);
            --text-base: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);
            --text-lg: clamp(1.125rem, 1rem + 0.625vw, 1.5rem);
            --text-xl: clamp(1.5rem, 1.3rem + 1vw, 2rem);
            --text-2xl: clamp(1.875rem, 1.5rem + 1.875vw, 2.5rem);
            --text-3xl: clamp(2.25rem, 1.8rem + 2.25vw, 3.5rem);
            
            --weight-light: 300;
            --weight-normal: 400;
            --weight-medium: 500;
            --weight-semibold: 600;
            --weight-bold: 700;
            
            --leading-tight: 1.25;
            --leading-normal: 1.5;
            --leading-relaxed: 1.75;
            
            --tracking-tight: -0.025em;
            --tracking-normal: 0;
            --tracking-wide: 0.025em;
            
            /* Animation Timing */
            --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ============================================
           BODY & BACKGROUND
           ============================================ */
        body {
            font-family: var(--font-body);
            background: var(--warm-cream);
            min-height: 100vh;
            color: var(--text-primary);
            padding-bottom: 100px;
            position: relative;
            overflow-x: hidden;
        }

        /* Fixed Background Image - Mother & Child */
        .background-image {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            max-width: 500px;
            height: auto;
            z-index: 0;
            pointer-events: none;
            opacity: 0.4;
                        mix-blend-mode: multiply;
                        filter: brightness(1.1) contrast(0.9);
            animation: gentle-float-bg 6s ease-in-out infinite;
        }

        .background-image img {
            width: 100%;
            height: auto;
            object-fit: contain;
        }

        @keyframes gentle-float-bg {
            0%, 100% {
                transform: translate(-50%, -50%) translateY(0);
            }
            50% {
                transform: translate(-50%, -50%) translateY(-15px);
            }
        }

        /* Soft overlay gradient for better content readability */
        .background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                180deg,
                rgba(245, 237, 228, 0.7) 0%,
                rgba(245, 240, 255, 0.6) 50%,
                rgba(245, 237, 228, 0.7) 100%
            );
            z-index: 0;
            pointer-events: none;
        }

        /* Subtle Particle Effect */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(149, 117, 205, 0.25);
            border-radius: 50%;
            animation: float 20s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) translateX(50px);
                opacity: 0;
            }
        }

        /* ============================================
           PRIORITY 1: ENHANCED HEADER
           ============================================ */
        .header {
            background: linear-gradient(
                135deg,
                rgba(255, 255, 255, 0.95) 0%,
                rgba(245, 240, 255, 0.95) 100%
            );
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 24px 20px;
            text-align: center;
            box-shadow: 
                0 4px 20px rgba(149, 117, 205, 0.08),
                0 1px 4px rgba(149, 117, 205, 0.05);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(149, 117, 205, 0.15);
        }

        .header h1 {
            font-size: var(--text-2xl);
            font-weight: var(--weight-bold);
            background: linear-gradient(135deg, var(--primary-lavender-700), var(--soft-pink-700));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            248

                        position: relative;
            align-items: center;
            justify-content: center;
            gap: 12px;
            letter-spacing: var(--tracking-tight);
        }

        .header h1::before {
            content: 'ðŸŒ¸';
            font-size: 1.2em;
            animation: gentle-float 3s ease-in-out infinite;
            display: inline-block;
            -webkit-text-fill-color: initial;
        }

                .header h1 .flower-icon {
            position: absolute;
            left: calc(50% - 180px);
            transform: translateX(-100%);
        }

        @keyframes gentle-float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-4px) rotate(5deg); }
        }

        .header p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin-top: 8px;
            font-weight: var(--weight-normal);
        }

        /* ============================================
           PRIORITY 1: FLOATING NAVIGATION BAR
           White with light purple accents
           ============================================ */
        .nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            padding: 12px 8px;
            position: fixed;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 32px);
            max-width: 600px;
            border-radius: 24px;
            box-shadow: 
                0 8px 32px rgba(149, 117, 205, 0.15),
                0 2px 8px rgba(149, 117, 205, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(149, 117, 205, 0.2);
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px 16px;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
            text-decoration: none;
            color: var(--text-secondary);
            font-size: var(--text-xs);
            font-weight: var(--weight-medium);
            min-width: 64px;
            min-height: 44px;
            position: relative;
            overflow: hidden;
            background: transparent;
            border: none;
        }

        .nav-item.active {
            background: var(--gradient-accent);
            color: var(--text-inverse);
            transform: translateY(-2px);
            box-shadow: 
                0 4px 12px rgba(149, 117, 205, 0.35),
                0 2px 4px rgba(149, 117, 205, 0.25);
        }

        .nav-item.active .icon {
            transform: scale(1.1);
        }

        .nav-item:not(.active):hover {
            background: var(--primary-lavender-50);
            color: var(--primary-lavender-700);
            transform: translateY(-1px);
        }

        .nav-item:focus-visible {
            outline: 3px solid var(--primary-lavender-500);
            outline-offset: 2px;
        }

        .nav-item .icon {
            font-size: 1.5rem;
            margin-bottom: 4px;
            transition: transform 0.3s var(--ease-smooth);
        }

        .nav-item:active .icon {
            transform: scale(0.9);
        }

        /* ============================================
           MAIN CONTENT
           ============================================ */
        .main-content {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        /* ============================================
           PRIORITY 2: PAGE TRANSITIONS
           ============================================ */
        .page {
            display: none;
            animation: page-fade-in 0.5s var(--ease-smooth);
        }

        .page.active {
            display: block;
            animation: page-fade-in 0.5s var(--ease-smooth);
        }

        @keyframes page-fade-in {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============================================
           PAGE HEADERS
           ============================================ */
        .page-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .page-header h2 {
            font-size: var(--text-2xl);
            font-weight: var(--weight-bold);
            color: var(--text-primary);
            margin-bottom: 8px;
            letter-spacing: var(--tracking-tight);
        }

        .page-header p {
            color: var(--text-secondary);
            font-size: var(--text-base);
            font-weight: var(--weight-normal);
        }

        /* ============================================
           PRIORITY 1: GLASSMORPHISM CARDS
           ============================================ */
        .card {
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(149, 117, 205, 0.15);
            border-radius: 24px;
            padding: 28px;
            margin-bottom: 20px;
            box-shadow: 
                0 8px 32px rgba(149, 117, 205, 0.1),
                0 2px 8px rgba(149, 117, 205, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            transition: all 0.3s var(--ease-smooth);
            position: relative;
            overflow: hidden;
            will-change: transform;
            transform: translateZ(0);
            animation: card-stagger 0.6s var(--ease-smooth) backwards;
        }

        .card:nth-child(1) { animation-delay: 0.1s; }
        .card:nth-child(2) { animation-delay: 0.2s; }
        .card:nth-child(3) { animation-delay: 0.3s; }
        .card:nth-child(4) { animation-delay: 0.4s; }

        @keyframes card-stagger {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.4),
                transparent
            );
            transition: left 0.5s;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 12px 40px rgba(149, 117, 205, 0.15),
                0 4px 12px rgba(149, 117, 205, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
        }

        .card:focus-visible {
            outline: 3px solid var(--primary-lavender-500);
            outline-offset: 4px;
        }

        /* Colored Card Variants */
        .card.lavender {
            background: linear-gradient(
                135deg,
                rgba(232, 223, 245, 0.9) 0%,
                rgba(255, 255, 255, 0.95) 100%
            );
            border-color: rgba(149, 117, 205, 0.25);
        }

        .card.pink {
            background: linear-gradient(
                135deg,
                rgba(252, 228, 236, 0.9) 0%,
                rgba(255, 255, 255, 0.95) 100%
            );
            border-color: rgba(232, 164, 184, 0.25);
        }

        .card.green {
            background: linear-gradient(
                135deg,
                rgba(212, 237, 218, 0.9) 0%,
                rgba(255, 255, 255, 0.95) 100%
            );
            border-color: rgba(124, 185, 132, 0.25);
        }

        .card.cream {
            background: linear-gradient(
                135deg,
                rgba(253, 236, 208, 0.9) 0%,
                rgba(255, 255, 255, 0.95) 100%
            );
            border-color: rgba(232, 184, 125, 0.25);
        }

        .card.blue {
            background: linear-gradient(
                135deg,
                rgba(208, 232, 245, 0.9) 0%,
                rgba(255, 255, 255, 0.95) 100%
            );
            border-color: rgba(126, 176, 213, 0.25);
        }

        .card-title {
            font-size: var(--text-lg);
            font-weight: var(--weight-semibold);
            color: var(--text-primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            line-height: var(--leading-tight);
        }

        .card-content {
            color: var(--text-secondary);
            line-height: var(--leading-relaxed);
            font-size: var(--text-base);
        }

        /* ============================================
           PRIORITY 1: INTERACTIVE HABIT ITEMS
           ============================================ */
        .placeholder-item,
        .habit-item {
            display: flex;
            align-items: center;
            padding: 16px;
            margin-bottom: 12px;
            background: var(--primary-lavender-50);
            border-radius: 16px;
            border: 2px solid transparent;
            transition: all 0.3s var(--ease-smooth);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .placeholder-item::before,
        .habit-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--gradient-accent);
            transform: scaleY(0);
            transition: transform 0.3s var(--ease-smooth);
        }

        .placeholder-item:hover,
        .habit-item:hover {
            background: #FFFFFF;
            border-color: var(--primary-lavender-200);
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(149, 117, 205, 0.12);
        }

        .placeholder-item:hover::before,
        .habit-item:hover::before {
            transform: scaleY(1);
        }

        .placeholder-item.completed,
        .habit-item.completed {
            background: linear-gradient(
                135deg,
                var(--success-green-light) 0%,
                #FFFFFF 100%
            );
            border-color: var(--success-green);
        }

        .placeholder-icon,
        .habit-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            font-size: 1.5rem;
            background: var(--gradient-accent);
            color: #FFFFFF;
            box-shadow: 0 4px 12px rgba(149, 117, 205, 0.3);
            transition: all 0.3s var(--ease-smooth);
            flex-shrink: 0;
        }

        .placeholder-item:hover .placeholder-icon,
        .habit-item:hover .habit-icon {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 16px rgba(149, 117, 205, 0.4);
        }

        .placeholder-icon.purple,
        .habit-icon.purple { background: var(--gradient-accent); }
        .placeholder-icon.pink,
        .habit-icon.pink { background: linear-gradient(135deg, var(--soft-pink-500), var(--soft-pink-300)); }
        .placeholder-icon.green,
        .habit-icon.green { background: linear-gradient(135deg, var(--success-green), #9ED4A4); }
        .placeholder-icon.orange,
        .habit-icon.orange { background: linear-gradient(135deg, var(--warning-orange), #F5CFA3); }
        .placeholder-icon.blue,
        .habit-icon.blue { background: linear-gradient(135deg, var(--info-blue), #A8D0EE); }

        .placeholder-text,
        .habit-text {
            flex: 1;
        }

        .placeholder-text h4,
        .habit-text h4 {
            font-size: var(--text-base);
            font-weight: var(--weight-semibold);
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .placeholder-text p,
        .habit-text p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
        }

        /* Habit Checkbox */
        .habit-checkbox {
            width: 24px;
            height: 24px;
            border-radius: 8px;
            border: 2px solid var(--primary-lavender-300);
            margin-left: auto;
            transition: all 0.3s var(--ease-smooth);
            position: relative;
            cursor: pointer;
            flex-shrink: 0;
        }

        .habit-checkbox.checked {
            background: var(--gradient-accent);
            border-color: transparent;
        }

        .habit-checkbox.checked::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            color: #FFFFFF;
            font-weight: bold;
            animation: checkmark-pop 0.3s var(--ease-smooth) forwards;
        }

        @keyframes checkmark-pop {
            0% { transform: translate(-50%, -50%) scale(0) rotate(-180deg); }
            50% { transform: translate(-50%, -50%) scale(1.2) rotate(0deg); }
            100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
        }

        /* ============================================
           PRIORITY 1: ENHANCED PROGRESS BARS
           ============================================ */
        .progress-bar {
            height: 12px;
            background: var(--primary-lavender-100);
            border-radius: 12px;
            overflow: hidden;
            margin-top: 16px;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(149, 117, 205, 0.1);
        }

        .progress-fill {
            height: 100%;
            border-radius: 12px;
            background: var(--gradient-accent);
            position: relative;
            overflow: hidden;
            transition: width 0.8s var(--ease-smooth);
            box-shadow: 
                0 2px 8px rgba(149, 117, 205, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.4),
                transparent
            );
            animation: progress-shine 2s infinite;
        }

        @keyframes progress-shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .progress-fill.purple { 
            background: linear-gradient(90deg, var(--primary-lavender-500), var(--primary-lavender-200));
        }
        .progress-fill.pink { 
            background: linear-gradient(90deg, var(--soft-pink-500), var(--soft-pink-300));
        }
        .progress-fill.green { 
            background: linear-gradient(90deg, var(--success-green), #9ED4A4);
        }
        .progress-fill.orange { 
            background: linear-gradient(90deg, var(--warning-orange), #F5CFA3);
        }
        .progress-fill.blue { 
            background: linear-gradient(90deg, var(--info-blue), #A8D0EE);
        }

        /* ============================================
           PRIORITY 1: ENHANCED STAT CARDS
           ============================================ */
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 16px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            padding: 24px 20px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid rgba(149, 117, 205, 0.15);
            box-shadow: 
                0 4px 16px rgba(149, 117, 205, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            transition: all 0.3s var(--ease-smooth);
            position: relative;
            overflow: hidden;
        }

        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-accent);
            transform: scaleX(0);
            transition: transform 0.3s var(--ease-smooth);
        }

        .stat-item:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 8px 24px rgba(149, 117, 205, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
        }

        .stat-item:hover::before {
            transform: scaleX(1);
        }

        .stat-value {
            font-size: var(--text-2xl);
            font-weight: var(--weight-bold);
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            animation: count-up 1s ease-out;
        }

        @keyframes count-up {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stat-label {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            font-weight: var(--weight-medium);
        }

        /* ============================================
           PRIORITY 1: ENHANCED LEVEL ITEMS
           ============================================ */
        .level-item {
            margin-bottom: 24px;
            padding: 20px;
            background: var(--primary-lavender-50);
            border-radius: 16px;
            transition: all 0.3s var(--ease-smooth);
        }

        .level-item:hover {
            background: #FFFFFF;
            box-shadow: 0 4px 12px rgba(149, 117, 205, 0.12);
        }

        .level-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .level-name {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: var(--weight-semibold);
            color: var(--text-primary);
            font-size: var(--text-base);
        }

        .level-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: var(--gradient-accent);
            box-shadow: 0 4px 12px rgba(149, 117, 205, 0.3);
        }

        .level-value {
            font-size: var(--text-lg);
            font-weight: var(--weight-bold);
            color: var(--primary-lavender-700);
        }

        .level-progress-bar {
            height: 16px;
            background: var(--primary-lavender-100);
            border-radius: 16px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(149, 117, 205, 0.1);
        }

        .level-progress-fill {
            height: 100%;
            border-radius: 16px;
            position: relative;
            transition: width 0.8s var(--ease-smooth);
            box-shadow: 
                0 2px 8px rgba(149, 117, 205, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }

        .level-progress-fill.purple {
            background: linear-gradient(90deg, var(--primary-lavender-500), var(--primary-lavender-300));
        }

        .level-progress-fill.orange {
            background: linear-gradient(90deg, var(--warning-orange), #F5CFA3);
        }

        .level-progress-fill.pink {
            background: linear-gradient(90deg, var(--soft-pink-500), var(--soft-pink-300));
        }

        .level-progress-fill.green {
            background: linear-gradient(90deg, var(--success-green), #9ED4A4);
        }

        /* ============================================
           PRIORITY 2: ENHANCED CHAT INTERFACE
           Dark text on light backgrounds for readability
           ============================================ */
        .chat-bubble {
            background: #FFFFFF;
            color: var(--text-primary);
            padding: 16px 20px;
            border-radius: 20px 20px 20px 6px;
            margin-bottom: 16px;
            max-width: 85%;
            position: relative;
            box-shadow: 0 2px 8px rgba(149, 117, 205, 0.12);
            animation: bubble-in 0.4s var(--ease-smooth);
            line-height: var(--leading-relaxed);
            border: 1px solid var(--primary-lavender-200);
        }

        .chat-bubble.user {
            background: var(--gradient-accent);
            color: #FFFFFF;
            border: none;
            margin-left: auto;
            border-radius: 20px 20px 6px 20px;
            box-shadow: 0 4px 12px rgba(149, 117, 205, 0.3);
        }

        @keyframes bubble-in {
            0% {
                opacity: 0;
                transform: translateY(10px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 16px 20px;
            background: #FFFFFF;
            border: 1px solid var(--primary-lavender-200);
            border-radius: 20px 20px 20px 6px;
            width: fit-content;
            margin-bottom: 16px;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary-lavender-500);
            animation: typing-bounce 1.4s infinite;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing-bounce {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.7;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* Enhanced Chat Input */
        .chat-input-placeholder {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            align-items: center;
        }

        .chat-input-placeholder input {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid var(--primary-lavender-200);
            border-radius: 24px;
            font-size: var(--text-base);
            outline: none;
            transition: all 0.3s var(--ease-smooth);
            background: #FFFFFF;
            color: var(--text-primary);
        }

        .chat-input-placeholder input::placeholder {
            color: var(--text-tertiary);
        }

        .chat-input-placeholder input:focus {
            border-color: var(--primary-lavender-500);
            box-shadow: 0 0 0 4px rgba(149, 117, 205, 0.15);
            transform: translateY(-2px);
        }

        .chat-input-placeholder button {
            background: var(--gradient-accent);
            color: #FFFFFF;
            border: none;
            padding: 16px 24px;
            border-radius: 24px;
            cursor: pointer;
            font-size: var(--text-base);
            font-weight: var(--weight-semibold);
            transition: all 0.3s var(--ease-smooth);
            box-shadow: 0 4px 12px rgba(149, 117, 205, 0.3);
            min-width: 80px;
        }

        .chat-input-placeholder button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(149, 117, 205, 0.4);
        }

        .chat-input-placeholder button:active {
            transform: translateY(0);
        }

        /* ============================================
           PRIORITY 2: LOADING STATES
           ============================================ */
        .skeleton {
            background: linear-gradient(
                90deg,
                var(--primary-lavender-100) 0%,
                var(--primary-lavender-50) 50%,
                var(--primary-lavender-100) 100%
            );
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s ease-in-out infinite;
            border-radius: 8px;
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--primary-lavender-200);
            border-top-color: var(--primary-lavender-500);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ============================================
           PRIORITY 2: SUCCESS/FEEDBACK ANIMATIONS
           ============================================ */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--success-green);
            color: #FFFFFF;
            padding: 16px 24px;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(124, 185, 132, 0.35);
            z-index: 1000;
            animation: toast-slide-up 0.4s var(--ease-smooth) forwards;
            font-weight: var(--weight-medium);
        }

        @keyframes toast-slide-up {
            to {
                transform: translateX(-50%) translateY(0);
            }
        }

        /* ============================================
           PRIORITY 3: RESPONSIVE DESIGN
           ============================================ */
        @media (max-width: 480px) {
            .main-content {
                padding: 16px;
            }
            
            .card {
                padding: 20px;
                border-radius: 20px;
            }
            
            .stat-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .nav {
                bottom: 12px;
                width: calc(100% - 24px);
                padding: 10px 6px;
            }
            
            .nav-item {
                padding: 8px 12px;
                min-width: 56px;
                font-size: 0.65rem;
            }

            .header h1 {
                font-size: var(--text-xl);
            }

            .page-header h2 {
                font-size: var(--text-xl);
            }
        }

        @media (min-width: 768px) and (max-width: 1024px) {
            .main-content {
                max-width: 700px;
            }
        }

        /* ============================================
           PRIORITY 3: ACCESSIBILITY ENHANCEMENTS
           ============================================ */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Focus states for keyboard navigation */
        button:focus-visible,
        input:focus-visible,
        .nav-item:focus-visible {
            outline: 3px solid var(--primary-lavender-500);
            outline-offset: 2px;
        }

        /* Screen reader only */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* ============================================
           FEATURE 1: CONFETTI CELEBRATION
           ============================================ */
        .celebration-pulse {
            animation: celebration-pulse 0.6s ease-out;
        }

        @keyframes celebration-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .toast.celebration {
            background: linear-gradient(135deg, var(--primary-lavender-500), var(--soft-pink-500));
            font-size: var(--text-lg);
            padding: 20px 32px;
        }

        /* ============================================
           FEATURE 2: ENLARGED STATS
           ============================================ */
        .stat-item.enlarged {
            padding: 32px 24px;
        }

        .stat-item.enlarged .stat-value {
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 12px;
            text-shadow: 0 2px 20px rgba(149, 117, 205, 0.3);
        }

        .stat-item.enlarged .stat-label {
            font-size: var(--text-base);
            font-weight: var(--weight-semibold);
        }

        .stat-value.counting {
            animation: number-glow 0.8s ease-out;
        }

        @keyframes number-glow {
            0% { 
                opacity: 0; 
                transform: translateY(20px) scale(0.8);
                filter: blur(4px);
            }
            50% {
                filter: blur(0);
            }
            100% { 
                opacity: 1; 
                transform: translateY(0) scale(1);
                filter: blur(0);
            }
        }

        /* ============================================
           FEATURE 3: COLOR-CODED HABIT CATEGORIES
           ============================================ */
        .placeholder-icon.hydration,
        .habit-icon.hydration {
            background: linear-gradient(135deg, #7EB0D5, #A8D0EE);
            box-shadow: 0 4px 12px rgba(126, 176, 213, 0.4);
        }

        .placeholder-icon.health,
        .habit-icon.health {
            background: linear-gradient(135deg, #F8BBD0, #FCE4EC);
            box-shadow: 0 4px 12px rgba(248, 187, 208, 0.4);
        }

        .placeholder-icon.movement,
        .habit-icon.movement {
            background: linear-gradient(135deg, #7CB984, #9ED4A4);
            box-shadow: 0 4px 12px rgba(124, 185, 132, 0.4);
        }

        .placeholder-icon.rest,
        .habit-icon.rest {
            background: linear-gradient(135deg, #B8A5D9, #D4C2E8);
            box-shadow: 0 4px 12px rgba(184, 165, 217, 0.4);
        }

        .placeholder-icon.mental,
        .habit-icon.mental {
            background: linear-gradient(135deg, #E8B87D, #F5CFA3);
            box-shadow: 0 4px 12px rgba(232, 184, 125, 0.4);
        }

        /* ============================================
           FEATURE 4: ENERGY-BASED SUGGESTIONS
           ============================================ */
        .card.suggestion {
            background: linear-gradient(
                135deg,
                rgba(255, 248, 231, 0.95) 0%,
                rgba(255, 255, 255, 0.95) 100%
            );
            border-color: rgba(232, 184, 125, 0.3);
        }

        .suggestion-text {
            font-size: var(--text-base);
            color: var(--text-primary);
            line-height: var(--leading-relaxed);
        }

        .energy-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            background: var(--primary-lavender-100);
            border-radius: 20px;
            font-size: var(--text-sm);
            color: var(--primary-lavender-700);
            margin-bottom: 12px;
        }

        /* ============================================
           FEATURE 5: QUICK WINS SHORTCUT BUTTONS
           Mobile-first: All 5 buttons visible without scrolling
           ============================================ */
        .quick-wins-container {
            margin-bottom: 20px;
            overflow-x: hidden;
            padding: 4px;
        }

        .quick-wins {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }

        .quick-win-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 8px 12px;
            height: 36px;
            background: var(--gradient-accent);
            color: #FFFFFF;
            border: none;
            border-radius: 18px;
            font-size: 0.75rem;
            font-weight: var(--weight-medium);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s var(--ease-smooth);
            box-shadow: 0 3px 10px rgba(149, 117, 205, 0.25);
            flex: 0 1 auto;
        }

        .quick-win-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 14px rgba(149, 117, 205, 0.35);
        }

        .quick-win-btn:active {
            transform: translateY(0);
        }

        /* Tablet and up - slightly larger buttons */
        @media (min-width: 480px) {
            .quick-win-btn {
                padding: 10px 14px;
                height: 38px;
                font-size: 0.8rem;
                gap: 5px;
            }
        }

        /* Desktop - full size buttons in single row */
        @media (min-width: 600px) {
            .quick-wins {
                flex-wrap: nowrap;
                justify-content: space-between;
            }
            
            .quick-win-btn {
                padding: 10px 16px;
                height: 40px;
                font-size: 0.85rem;
                gap: 6px;
                flex: 1 1 0;
            }
        }

        /* ============================================
           SOUND MUTE TOGGLE
           ============================================ */
        .mute-toggle {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary-lavender-50);
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s var(--ease-smooth);
            box-shadow: 0 2px 8px rgba(149, 117, 205, 0.15);
        }

        .mute-toggle:hover {
            background: var(--primary-lavender-100);
            transform: translateY(-50%) scale(1.1);
        }

        .mute-toggle.muted {
            background: var(--soft-pink-100);
        }

        .header {
            position: relative;
        }

        /* ============================================
           FEATURE 6 & 7: GRACE DAY & STREAK FREEZE
           ============================================ */
        .streak-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 8px;
        }

        .streak-shield {
            font-size: 1.2rem;
            animation: shield-glow 2s ease-in-out infinite;
        }

        @keyframes shield-glow {
            0%, 100% { 
                filter: drop-shadow(0 0 4px rgba(255, 193, 7, 0.5));
            }
            50% { 
                filter: drop-shadow(0 0 12px rgba(255, 193, 7, 0.8));
            }
        }

        .grace-day-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #FFD54F, #FFC107);
            color: var(--text-dark);
            border: none;
            border-radius: 16px;
            font-size: var(--text-sm);
            font-weight: var(--weight-semibold);
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
            margin-top: 16px;
        }

        .grace-day-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 193, 7, 0.4);
        }

        .grace-day-btn:disabled {
            background: var(--primary-lavender-100);
            color: var(--text-tertiary);
            cursor: not-allowed;
            box-shadow: none;
        }

        .grace-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: rgba(255, 193, 7, 0.2);
            border-radius: 12px;
            font-size: var(--text-xs);
            color: var(--text-primary);
        }

        .grace-progress {
            font-size: var(--text-xs);
            color: var(--text-tertiary);
            margin-top: 8px;
        }

        .streak-protected {
            position: relative;
        }

        .streak-protected::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 24px;
            background: linear-gradient(135deg, rgba(255, 213, 79, 0.3), rgba(255, 193, 7, 0.1));
            animation: protection-glow 3s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes protection-glow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* ============================================
           FEATURE 8: PHOTO UPLOAD
           ============================================ */
        .photo-upload-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--primary-lavender-100);
        }

        .photo-upload-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: var(--primary-lavender-50);
            color: var(--primary-lavender-700);
            border: 2px dashed var(--primary-lavender-200);
            border-radius: 12px;
            font-size: var(--text-sm);
            font-weight: var(--weight-medium);
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
        }

        .photo-upload-btn:hover {
            background: var(--primary-lavender-100);
            border-color: var(--primary-lavender-300);
        }

        .photo-preview {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 12px;
        }

        .photo-thumbnail-container {
            position: relative;
            display: inline-block;
        }

        .photo-thumbnail {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            object-fit: cover;
            border: 2px solid var(--primary-lavender-200);
        }

        .photo-remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--soft-pink-500);
            color: #FFFFFF;
            border: 2px solid #FFFFFF;
            font-size: 0.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s var(--ease-smooth);
            box-shadow: 0 2px 6px rgba(232, 164, 184, 0.4);
        }

        .photo-remove-btn:hover {
            background: var(--soft-pink-700);
            transform: scale(1.1);
        }

        .photo-placeholder {
            font-size: var(--text-sm);
            color: var(--text-tertiary);
            font-style: italic;
        }

        /* Timer Alert Animation */
        .timer-display.alert {
            animation: timer-alert 0.5s ease-in-out 3;
            color: var(--success-green-light);
            text-shadow: 0 0 20px rgba(124, 185, 132, 0.5);
        }

        /* Breathing timer uses lavender color */
        #breathing-timer.alert {
            color: var(--primary-lavender-200);
            text-shadow: 0 0 20px rgba(184, 165, 217, 0.5);
        }

        @keyframes timer-alert {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        .timer-complete-message {
            font-size: var(--text-lg);
            color: var(--success-green-light);
            margin-top: 16px;
            animation: fade-in 0.3s ease-out;
        }

        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Photo fade-out animation */
        .photo-thumbnail-container.removing {
            animation: photo-fade-out 0.3s ease-out forwards;
        }

        @keyframes photo-fade-out {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.8); }
        }

        /* ============================================
           FEATURE 9: ACHIEVEMENT BADGES
           ============================================ */
        .achievements-section {
            margin-top: 20px;
        }

        .badges-scroll {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            padding: 8px 0;
        }

        .badges-scroll::-webkit-scrollbar {
            display: none;
        }

        .badges-container {
            display: flex;
            gap: 16px;
        }

        .badge-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            border: 3px solid var(--primary-lavender-200);
            flex-shrink: 0;
            transition: all 0.3s var(--ease-smooth);
            position: relative;
        }

        .badge-item.unlocked {
            border-color: var(--primary-lavender-500);
            animation: badge-pulse 2s ease-in-out infinite;
        }

        .badge-item.locked {
            filter: grayscale(100%);
            opacity: 0.5;
        }

        .badge-item.locked::after {
            content: 'ðŸ”’';
            position: absolute;
            bottom: -4px;
            right: -4px;
            font-size: 1rem;
            background: #FFFFFF;
            border-radius: 50%;
            padding: 2px;
        }

        @keyframes badge-pulse {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(149, 117, 205, 0.4);
            }
            50% { 
                box-shadow: 0 0 0 8px rgba(149, 117, 205, 0);
            }
        }

        .badge-icon {
            font-size: 1.8rem;
        }

        .badge-label {
            font-size: 0.6rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 4px;
            max-width: 70px;
            line-height: 1.2;
        }

        /* ============================================
           FEATURE 10: SWIPE NAVIGATION
           ============================================ */
        .swipe-indicator {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
            color: var(--primary-lavender-300);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 50;
        }

        .swipe-indicator.left {
            left: 8px;
        }

        .swipe-indicator.right {
            right: 8px;
        }

        .swipe-indicator.show {
            opacity: 1;
            animation: swipe-hint 1.5s ease-in-out infinite;
        }

        @keyframes swipe-hint {
            0%, 100% { transform: translateY(-50%) translateX(0); }
            50% { transform: translateY(-50%) translateX(5px); }
        }

        .swipe-indicator.left.show {
            animation: swipe-hint-left 1.5s ease-in-out infinite;
        }

        @keyframes swipe-hint-left {
            0%, 100% { transform: translateY(-50%) translateX(0); }
            50% { transform: translateY(-50%) translateX(-5px); }
        }

        .page.swiping {
            transition: transform 0.05s linear;
        }

        .page.swipe-transition {
            transition: transform 0.3s var(--ease-smooth), opacity 0.3s var(--ease-smooth);
        }

        /* ============================================
           MODAL STYLES
           ============================================ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(74, 59, 92, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s var(--ease-smooth);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: #FFFFFF;
            border-radius: 24px;
            padding: 32px;
            max-width: 90%;
            width: 360px;
            box-shadow: 0 20px 60px rgba(149, 117, 205, 0.3);
            transform: translateY(20px) scale(0.95);
            transition: all 0.3s var(--ease-smooth);
        }

        .modal-overlay.active .modal {
            transform: translateY(0) scale(1);
        }

        .modal-title {
            font-size: var(--text-xl);
            font-weight: var(--weight-bold);
            color: var(--text-primary);
            margin-bottom: 16px;
            text-align: center;
        }

        .modal-content {
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 24px;
            line-height: var(--leading-relaxed);
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px 20px;
            border-radius: 16px;
            font-size: var(--text-base);
            font-weight: var(--weight-semibold);
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
            border: none;
        }

        .modal-btn.primary {
            background: var(--gradient-accent);
            color: #FFFFFF;
        }

        .modal-btn.secondary {
            background: var(--primary-lavender-50);
            color: var(--primary-lavender-700);
        }

        .modal-btn:hover {
            transform: translateY(-2px);
        }

        /* Timer Overlay */
        .timer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(74, 59, 92, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 300;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s var(--ease-smooth);
        }

        .timer-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .timer-display {
            font-size: 5rem;
            font-weight: 800;
            color: #FFFFFF;
            margin-bottom: 20px;
        }

        .timer-label {
            font-size: var(--text-xl);
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 40px;
        }

        .timer-close {
            padding: 16px 32px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 24px;
            color: #FFFFFF;
            font-size: var(--text-base);
            font-weight: var(--weight-semibold);
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
        }

        .timer-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Breathing Guide */
        .breathing-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-lavender-500), var(--soft-pink-500));
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            animation: breathe 8s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(0.8); }
            50% { transform: scale(1.2); }
        }

        .breathing-text {
            font-size: var(--text-2xl);
            font-weight: var(--weight-bold);
            color: #FFFFFF;
        }

        /* Quick Note Modal */
        .quick-note-textarea {
            width: 100%;
            min-height: 120px;
            padding: 16px;
            border: 2px solid var(--primary-lavender-200);
            border-radius: 16px;
            font-size: var(--text-base);
            font-family: var(--font-body);
            resize: none;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .quick-note-textarea:focus {
            outline: none;
            border-color: var(--primary-lavender-500);
        }

        /* Water Counter */
        .water-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 20px;
        }

        .water-count {
            font-size: 3rem;
            font-weight: 800;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .water-glasses {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 200px;
        }

        .water-glass {
            font-size: 1.5rem;
            opacity: 0.3;
            transition: all 0.3s var(--ease-smooth);
        }

        .water-glass.filled {
            opacity: 1;
            transform: scale(1.1);
        }
    </style>
    <!-- Canvas Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
</head>
<body>
    <!-- Fixed Background Image - Mother & Child -->
    <div class="background-image">
        <img src="mother-child-background.png" alt="" aria-hidden="true">
    </div>
    <div class="background-overlay"></div>

    <!-- Subtle Particle Effect -->
    <div class="particles" id="particles"></div>

    <!-- Audio Elements for Sound Effects -->
    <!-- All habits complete/Confetti: Party blower + Toddler laughing (play BOTH simultaneously) -->
    <audio id="all-complete-sound-1" src="Sounds/BOOM Library - Cartoon Elements - Party Blower Hooting .mp3" preload="auto"></audio>
    <audio id="all-complete-sound-2" src="Sounds/Julien Matthey - Human Reactions - Happy Toddler Laughing.mp3" preload="auto"></audio>
    <!-- 2-Min Stretch timer end: Baby laughing joyfully -->
    <audio id="stretch-timer-sound" src="Sounds/DB studios - Baby laughing joyfully .mp3" preload="auto"></audio>
    <!-- Deep Breath timer end: Baby squealing/babbling -->
    <audio id="breath-timer-sound" src="Sounds/Sound Ex Machina - Baby - Fourteen Months Old Boy Happy Squealing Babbling Growling.mp3" preload="auto"></audio>

    <!-- Header -->
    <header class="header" role="banner">
        <h1><span class="flower-icon">ðŸŒ¸</span> Mother Habit Tracker</h1>
        <p>Nurturing yourself, nurturing your little one</p>
        <button class="mute-toggle" id="mute-toggle" type="button" aria-label="Toggle sound" title="Toggle sound effects">
            ðŸ”Š
        </button>
    </header>

    <!-- Main Content -->
    <main class="main-content" role="main">
        <!-- Today Page -->
        <section id="today" class="page active" role="region" aria-labelledby="today-heading">
            <div class="page-header">
                <h2 id="today-heading">Today</h2>
                <p id="today-date">Wednesday, December 24</p>
            </div>

            <!-- Quick Wins Shortcut Buttons -->
            <div class="quick-wins-container" role="region" aria-label="Quick actions">
                <div class="quick-wins">
                    <button class="quick-win-btn" id="quick-water" type="button" aria-label="Log water intake">
                        ðŸ’§ Log Water
                    </button>
                    <button class="quick-win-btn" id="quick-stretch" type="button" aria-label="Start 2 minute stretch timer">
                        ðŸ§˜ 2-Min Stretch
                    </button>
                    <button class="quick-win-btn" id="quick-breath" type="button" aria-label="Start breathing guide">
                        ðŸ˜®â€ðŸ’¨ Deep Breath
                    </button>
                    <button class="quick-win-btn" id="quick-note" type="button" aria-label="Write quick note">
                        ðŸ“ Quick Note
                    </button>
                    <button class="quick-win-btn" id="quick-checkin" type="button" aria-label="Go to check-in">
                        âœ… Check-in
                    </button>
                </div>
            </div>

            <div class="card lavender" role="article">
                <div class="card-title">ðŸŒ… Good Morning, Mama!</div>
                <div class="card-content">
                    You're doing amazing. Here's your wellness check-in for today.
                </div>
            </div>

            <div class="card" role="article" aria-labelledby="habits-title" id="todays-habits-card">
                <div class="card-title" id="habits-title">ðŸ“‹ Today's Habits</div>
                <div class="placeholder-item today-habit" role="button" tabindex="0" aria-label="Drink Water habit" data-category="hydration">
                    <div class="placeholder-icon hydration">ðŸ’§</div>
                    <div class="placeholder-text">
                        <h4>Drink Water</h4>
                        <p>Stay hydrated for you and baby</p>
                    </div>
                    <div class="habit-checkbox" role="checkbox" aria-checked="false"></div>
                </div>
                <div class="placeholder-item today-habit" role="button" tabindex="0" aria-label="5-Minute Stretch habit" data-category="movement">
                    <div class="placeholder-icon movement">ðŸ§˜</div>
                    <div class="placeholder-text">
                        <h4>5-Minute Stretch</h4>
                        <p>Gentle movement for recovery</p>
                    </div>
                    <div class="habit-checkbox" role="checkbox" aria-checked="false"></div>
                </div>
                <div class="placeholder-item today-habit" role="button" tabindex="0" aria-label="Rest When Baby Rests habit" data-category="rest">
                    <div class="placeholder-icon rest">ðŸ˜´</div>
                    <div class="placeholder-text">
                        <h4>Rest When Baby Rests</h4>
                        <p>Self-care is not selfish</p>
                    </div>
                    <div class="habit-checkbox" role="checkbox" aria-checked="false"></div>
                </div>
                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Habits completion progress">
                    <div class="progress-fill purple" id="habits-progress" style="width: 0%;"></div>
                </div>
            </div>

            <div class="card pink" role="article" id="affirmation-card">
                <div class="card-title">ðŸ’­ Daily Affirmation</div>
                <div class="card-content">
                    "I am exactly the mother my baby needs. I trust myself and my journey."
                </div>
                <!-- Photo Upload Section -->
                <div class="photo-upload-section">
                    <label class="photo-upload-btn" for="photo-input">
                        ðŸ“¸ Add Today's Moment
                    </label>
                    <input type="file" id="photo-input" accept="image/*" style="display: none;" aria-label="Upload photo">
                    <div class="photo-preview" id="photo-preview">
                        <span class="photo-placeholder">Capture a special moment from today</span>
                    </div>
                </div>
            </div>

            <!-- Energy-Based Suggestions -->
            <div class="card suggestion" role="article" id="energy-suggestions">
                <div class="card-title">ðŸ’¡ Suggested for You</div>
                <div class="energy-indicator" id="energy-level-display">
                    <span>âš¡</span> <span id="current-energy">Medium Energy (5/10)</span>
                </div>
                <div class="suggestion-text" id="suggestion-text">
                    You've got steady energy! Try your stretch + a short walk ðŸŒ¿
                </div>
            </div>
        </section>

        <!-- Habits Page -->
        <section id="habits" class="page" role="region" aria-labelledby="habits-page-heading">
            <div class="page-header">
                <h2 id="habits-page-heading">My Habits</h2>
                <p>Build routines that support your wellness</p>
            </div>

            <div class="card" role="article" aria-labelledby="active-habits-title">
                <div class="card-title" id="active-habits-title">ðŸ’ª Active Habits</div>
                <div class="placeholder-item" role="button" tabindex="0" aria-label="Hydration habit" data-category="hydration">
                    <div class="placeholder-icon hydration">ðŸ’§</div>
                    <div class="placeholder-text">
                        <h4>Hydration</h4>
                        <p>8 glasses daily â€¢ 5 day streak</p>
                    </div>
                </div>
                <div class="placeholder-item" role="button" tabindex="0" aria-label="Prenatal Vitamins habit" data-category="health">
                    <div class="placeholder-icon health">ðŸ’Š</div>
                    <div class="placeholder-text">
                        <h4>Prenatal Vitamins</h4>
                        <p>Once daily â€¢ 12 day streak</p>
                    </div>
                </div>
                <div class="placeholder-item" role="button" tabindex="0" aria-label="Fresh Air Walk habit" data-category="movement">
                    <div class="placeholder-icon movement">ðŸŒ¿</div>
                    <div class="placeholder-text">
                        <h4>Fresh Air Walk</h4>
                        <p>15 minutes â€¢ 3 day streak</p>
                    </div>
                </div>
                <div class="placeholder-item" role="button" tabindex="0" aria-label="Gratitude Journal habit" data-category="mental">
                    <div class="placeholder-icon mental">ðŸ“”</div>
                    <div class="placeholder-text">
                        <h4>Gratitude Journal</h4>
                        <p>Evening â€¢ 7 day streak</p>
                    </div>
                </div>
            </div>

            <div class="card green" role="article">
                <div class="card-title">âœ¨ Suggested Habits</div>
                <div class="card-content">
                    Based on your journey, you might enjoy adding: Pelvic floor exercises, Skin-to-skin time, or a Mindful breathing practice.
                </div>
            </div>
        </section>

        <!-- Insights Page -->
        <section id="insights" class="page" role="region" aria-labelledby="insights-heading">
            <div class="page-header">
                <h2 id="insights-heading">Insights</h2>
                <p>Celebrate your progress</p>
            </div>

            <div class="card lavender" role="article" aria-labelledby="summary-title">
                <div class="card-title" id="summary-title">ðŸ“Š This Week's Summary</div>
                <div class="stat-grid">
                    <div class="stat-item enlarged" role="article">
                        <div class="stat-value" data-target="85" data-suffix="%">0%</div>
                        <div class="stat-label">Habits Completed</div>
                    </div>
                    <div class="stat-item enlarged" role="article" id="streak-stat">
                        <div class="streak-container">
                            <div class="stat-value" data-target="12" data-suffix="">0</div>
                            <span class="streak-shield" id="streak-shield" style="display: none;" title="Protected by Grace Day">ðŸ›¡ï¸</span>
                        </div>
                        <div class="stat-label">Day Streak</div>
                        <div class="grace-badge" id="grace-badge">
                            ðŸ›¡ï¸ Grace Days: <span id="grace-count">2</span>/3
                        </div>
                    </div>
                    <div class="stat-item enlarged" role="article">
                        <div class="stat-value" data-target="4" data-suffix="">0</div>
                        <div class="stat-label">Active Habits</div>
                    </div>
                    <div class="stat-item enlarged" role="article">
                        <div class="stat-value" data-target="28" data-suffix="">0</div>
                        <div class="stat-label">Total Check-ins</div>
                    </div>
                </div>
                <!-- Grace Day Button -->
                <button class="grace-day-btn" id="grace-day-btn" type="button">
                    ðŸ›¡ï¸ Use Grace Day
                </button>
                <div class="grace-progress" id="grace-progress">Complete 5 more days to earn next Grace Day</div>
            </div>

            <!-- Achievement Badges -->
            <div class="card" role="article" aria-labelledby="badges-title">
                <div class="card-title" id="badges-title">ðŸ† Achievements</div>
                <div class="badges-scroll">
                    <div class="badges-container">
                        <div class="badge-item unlocked" role="img" aria-label="First Week Complete badge - unlocked">
                            <span class="badge-icon">â­</span>
                            <span class="badge-label">First Week</span>
                        </div>
                        <div class="badge-item unlocked" role="img" aria-label="Hydration Hero badge - unlocked">
                            <span class="badge-icon">ðŸ’§</span>
                            <span class="badge-label">Hydration Hero</span>
                        </div>
                        <div class="badge-item unlocked" role="img" aria-label="7-Day Streak badge - unlocked">
                            <span class="badge-icon">ðŸ”¥</span>
                            <span class="badge-label">7-Day Streak</span>
                        </div>
                        <div class="badge-item unlocked" role="img" aria-label="Self-Care Champion badge - unlocked">
                            <span class="badge-icon">ðŸ’œ</span>
                            <span class="badge-label">Self-Care Champ</span>
                        </div>
                        <div class="badge-item locked" role="img" aria-label="30-Day Warrior badge - locked">
                            <span class="badge-icon">ðŸ†</span>
                            <span class="badge-label">30-Day Warrior</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card cream" role="article">
                <div class="card-title">ðŸ’¡ Wellness Tip</div>
                <div class="card-content">
                    Your most consistent habit is taking vitamins in the morning. Try "habit stacking" by adding another small habit right after!
                </div>
            </div>
        </section>

        <!-- My Levels Page -->
        <section id="levels" class="page" role="region" aria-labelledby="levels-heading">
            <div class="page-header">
                <h2 id="levels-heading">My Levels</h2>
                <p>Track how you're feeling</p>
            </div>

            <div class="card" role="article" aria-labelledby="checkin-title">
                <div class="card-title" id="checkin-title">ðŸŒ¡ï¸ Today's Check-in</div>
                
                <div class="level-item" role="article">
                    <div class="level-header">
                        <span class="level-name">ðŸ˜´ Sleep Quality</span>
                        <span class="level-value">6/10</span>
                    </div>
                    <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" aria-label="Sleep Quality: 6 out of 10">
                        <div class="progress-fill purple" style="width: 60%;"></div>
                    </div>
                </div>

                <div class="level-item" role="article">
                    <div class="level-header">
                        <span class="level-name">âš¡ Energy Level</span>
                        <span class="level-value">5/10</span>
                    </div>
                    <div class="progress-bar" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" aria-label="Energy Level: 5 out of 10">
                        <div class="progress-fill orange" style="width: 50%;"></div>
                    </div>
                </div>

                <div class="level-item" role="article">
                    <div class="level-header">
                        <span class="level-name">ðŸ˜Š Mood</span>
                        <span class="level-value">7/10</span>
                    </div>
                    <div class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" aria-label="Mood: 7 out of 10">
                        <div class="progress-fill pink" style="width: 70%;"></div>
                    </div>
                </div>

                <div class="level-item" role="article">
                    <div class="level-header">
                        <span class="level-name">ðŸ’ª Physical Comfort</span>
                        <span class="level-value">6/10</span>
                    </div>
                    <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" aria-label="Physical Comfort: 6 out of 10">
                        <div class="progress-fill green" style="width: 60%;"></div>
                    </div>
                </div>
            </div>

            <div class="card blue" role="article">
                <div class="card-title">ðŸ“ˆ Weekly Trends</div>
                <div class="card-content">
                    Your mood has been steadily improving over the past week. Sleep quality tends to be better on days when you complete your evening wind-down routine.
                </div>
            </div>
        </section>

        <!-- AI Coach Page -->
        <section id="coach" class="page" role="region" aria-labelledby="coach-heading">
            <div class="page-header">
                <h2 id="coach-heading">AI Coach</h2>
                <p>Your supportive wellness companion</p>
            </div>

            <div class="card" role="article" aria-labelledby="chat-title">
                <div class="card-title" id="chat-title">ðŸ’¬ Chat with Your Coach</div>
                
                <div class="chat-bubble" role="article" aria-label="AI Coach message">
                    Hi there, mama! ðŸŒ¸ I'm here to support you on your postpartum journey. How are you feeling today? Remember, there's no wrong answer â€“ I'm here to listen and help.
                </div>

                <div class="chat-bubble user" role="article" aria-label="Your message">
                    I'm feeling a bit overwhelmed today.
                </div>

                <div class="chat-bubble" role="article" aria-label="AI Coach message">
                    That's completely understandable, and thank you for sharing that with me. Feeling overwhelmed is so normal during this time. Would you like some gentle suggestions for managing these feelings, or would you prefer to just talk about what's on your mind?
                </div>

                <div class="chat-input-placeholder">
                    <input type="text" placeholder="Type your message..." aria-label="Chat message input">
                    <button type="button" aria-label="Send message">Send</button>
                </div>
            </div>

            <div class="card pink" role="article">
                <div class="card-title">ðŸŽ¯ Quick Topics</div>
                <div class="card-content">
                    â€¢ Sleep strategies for new moms<br>
                    â€¢ Managing postpartum emotions<br>
                    â€¢ Self-care in small moments<br>
                    â€¢ Building a support system
                </div>
            </div>
        </section>
    </main>

    <!-- Swipe Indicators -->
    <div class="swipe-indicator left" id="swipe-left" aria-hidden="true">â€¹</div>
    <div class="swipe-indicator right" id="swipe-right" aria-hidden="true">â€º</div>

    <!-- Timer Overlay -->
    <div class="timer-overlay" id="timer-overlay" role="dialog" aria-label="Timer">
        <div class="timer-display" id="timer-display">2:00</div>
        <div class="timer-label" id="timer-label">ðŸ§˜ Stretch Time</div>
        <button class="timer-close" id="timer-close" type="button">Close</button>
    </div>

    <!-- Breathing Guide Overlay -->
    <div class="timer-overlay" id="breathing-overlay" role="dialog" aria-label="Breathing guide">
        <div class="breathing-circle">
            <span class="breathing-text" id="breathing-text">Breathe In</span>
        </div>
        <div class="timer-display" id="breathing-timer">0:30</div>
        <div class="timer-label">Deep Breathing Exercise</div>
        <button class="timer-close" id="breathing-close" type="button">Close</button>
    </div>

    <!-- Quick Note Modal -->
    <div class="modal-overlay" id="note-modal" role="dialog" aria-label="Quick note">
        <div class="modal">
            <div class="modal-title">ðŸ“ Quick Note</div>
            <textarea class="quick-note-textarea" id="quick-note-text" placeholder="What's on your mind, mama?"></textarea>
            <div class="modal-buttons">
                <button class="modal-btn secondary" id="note-cancel" type="button">Cancel</button>
                <button class="modal-btn primary" id="note-save" type="button">Save</button>
            </div>
        </div>
    </div>

    <!-- Water Counter Modal -->
    <div class="modal-overlay" id="water-modal" role="dialog" aria-label="Water tracker">
        <div class="modal">
            <div class="modal-title">ðŸ’§ Water Tracker</div>
            <div class="water-counter">
                <button class="modal-btn secondary" id="water-minus" type="button" style="flex: 0; padding: 14px 20px;">âˆ’</button>
                <div class="water-count" id="water-count">0</div>
                <button class="modal-btn primary" id="water-plus" type="button" style="flex: 0; padding: 14px 20px;">+</button>
            </div>
            <div class="water-glasses" id="water-glasses">
                <span class="water-glass">ðŸ’§</span>
                <span class="water-glass">ðŸ’§</span>
                <span class="water-glass">ðŸ’§</span>
                <span class="water-glass">ðŸ’§</span>
                <span class="water-glass">ðŸ’§</span>
                <span class="water-glass">ðŸ’§</span>
                <span class="water-glass">ðŸ’§</span>
                <span class="water-glass">ðŸ’§</span>
            </div>
            <div class="modal-content" style="margin-top: 16px; margin-bottom: 16px;">Goal: 8 glasses per day</div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" id="water-close" type="button">Close</button>
            </div>
        </div>
    </div>

    <!-- Grace Day Confirmation Modal -->
    <div class="modal-overlay" id="grace-modal" role="dialog" aria-label="Grace day confirmation">
        <div class="modal">
            <div class="modal-title">ðŸ›¡ï¸ Use a Grace Day?</div>
            <div class="modal-content">
                This will protect your <strong>12-day streak</strong> today, even if you don't complete all your habits. You have <strong id="grace-remaining">2</strong> Grace Days remaining.
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" id="grace-cancel" type="button">Cancel</button>
                <button class="modal-btn primary" id="grace-confirm" type="button">Use Grace Day</button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav" role="navigation" aria-label="Main navigation">
        <button class="nav-item active" 
                aria-label="Today page" 
                aria-current="page"
                data-page="today"
                type="button">
            <span class="icon" aria-hidden="true">ðŸ </span>
            Today
        </button>
        <button class="nav-item" 
                aria-label="Habits page"
                data-page="habits"
                type="button">
            <span class="icon" aria-hidden="true">âœ“</span>
            Habits
        </button>
        <button class="nav-item" 
                aria-label="Insights page"
                data-page="insights"
                type="button">
            <span class="icon" aria-hidden="true">ðŸ“Š</span>
            Insights
        </button>
        <button class="nav-item" 
                aria-label="My Levels page"
                data-page="levels"
                type="button">
            <span class="icon" aria-hidden="true">ðŸ’«</span>
            My Levels
        </button>
        <button class="nav-item" 
                aria-label="AI Coach page"
                data-page="coach"
                type="button">
            <span class="icon" aria-hidden="true">ðŸ¤–</span>
            AI Coach
        </button>
    </nav>

    <script>
        // ============================================
        // APP STATE
        // ============================================
        const appState = {
            completedHabits: 0,
            totalHabits: 3,
            energyLevel: 5,
            graceDays: 2,
            maxGraceDays: 3,
            streakProtected: false,
            waterCount: 0,
            currentPage: 0,
            pages: ['today', 'habits', 'insights', 'levels', 'coach'],
            firstVisit: !localStorage.getItem('visitedBefore'),
            soundEnabled: localStorage.getItem('soundEnabled') !== 'false',
            celebrationShown: false
        };

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // ============================================
        // SOUND SYSTEM
        // ============================================
        function playSound(soundId) {
            if (!appState.soundEnabled) return;
            
            const audio = document.getElementById(soundId);
            if (audio) {
                audio.currentTime = 0;
                audio.play().catch(err => {
                    // Graceful error handling - sounds may not exist yet
                    console.log('Sound not available:', soundId);
                });
            }
        }

        function initSoundSystem() {
            const muteToggle = document.getElementById('mute-toggle');
            
            // Set initial state
            updateMuteButton();
            
            muteToggle?.addEventListener('click', () => {
                appState.soundEnabled = !appState.soundEnabled;
                localStorage.setItem('soundEnabled', appState.soundEnabled);
                updateMuteButton();
            });
            
            function updateMuteButton() {
                if (muteToggle) {
                    muteToggle.textContent = appState.soundEnabled ? 'ðŸ”Š' : 'ðŸ”‡';
                    muteToggle.classList.toggle('muted', !appState.soundEnabled);
                    muteToggle.title = appState.soundEnabled ? 'Sound on - click to mute' : 'Sound off - click to unmute';
                }
            }
        }

        // ============================================
        // AI COACH RESPONSES
        // ============================================
        const aiResponses = {
            tired: [
                "It's completely normal to feel tired. Your body is doing incredible work. Have you been able to rest when baby sleeps? ðŸ’œ",
                "Exhaustion is so real during this time. Remember, you don't have to do everything. What's one thing you can let go of today? ðŸ’œ",
                "I hear you, mama. Tiredness is your body asking for rest. Even small moments of stillness can help. You're doing amazing. ðŸ’œ",
                "Being tired is so hard. Your body has been through so much. Can you carve out even 10 minutes of rest for yourself? ðŸ’œ"
            ],
            overwhelmed: [
                "I hear you, mama. Taking things one moment at a time is all you need to do. What's one small thing that might help right now? ðŸ’œ",
                "Feeling overwhelmed is completely valid. You're handling so much. Would you like to talk through what's on your mind? ðŸ’œ",
                "It's okay to feel overwhelmed - this is a big adjustment. Remember, you don't have to have it all figured out. ðŸ’œ",
                "When everything feels like too much, try focusing on just the next hour. You've got this, one step at a time. ðŸ’œ"
            ],
            stressed: [
                "Stress is so common during this time. Have you tried a few deep breaths? Even 30 seconds can help reset your nervous system. ðŸ’œ",
                "I understand that stress, mama. What's weighing on you most right now? Sometimes naming it helps. ðŸ’œ",
                "Stress can feel so heavy. Remember, it's okay to ask for help. You don't have to carry everything alone. ðŸ’œ"
            ],
            anxious: [
                "Anxiety can feel so overwhelming. You're not alone in this. Would it help to talk about what's making you feel this way? ðŸ’œ",
                "Those anxious feelings are valid. Remember, they're just feelings - they don't define you or your abilities as a mother. ðŸ’œ",
                "I'm here with you through the anxiety. Sometimes grounding exercises can help - try noticing 5 things you can see around you. ðŸ’œ"
            ],
            happy: [
                "That's wonderful to hear! Celebrating these moments is so important. You're doing amazing! ðŸ’œ",
                "I love hearing this! These happy moments are precious. What made today feel good? ðŸ’œ",
                "Yay! Your joy is contagious! Savor this feeling, mama - you deserve all the happiness. ðŸ’œ",
                "This makes me so happy to hear! You're thriving, and it shows. Keep celebrating the wins! ðŸ’œ"
            ],
            good: [
                "That's great! I'm so glad you're feeling good today. What's been going well? ðŸ’œ",
                "Wonderful! It's lovely to hear you're having a good day. You deserve it! ðŸ’œ",
                "So glad to hear things are going well! What's bringing you joy today? ðŸ’œ"
            ],
            sleep: [
                "Sleep is so precious and often elusive with a little one. Are you able to rest when baby rests? ðŸ’œ",
                "Sleep deprivation is real and hard. Remember, this phase won't last forever. Be gentle with yourself. ðŸ’œ",
                "Getting enough sleep is tough! Have you tried any sleep-when-baby-sleeps strategies? I'm here to help brainstorm. ðŸ’œ"
            ],
            baby: [
                "How are things going with your little one? Every baby is different, and you're learning together. ðŸ’œ",
                "Your baby is so lucky to have you. Trust your instincts - you know your little one best. ðŸ’œ",
                "Caring for a baby is a beautiful journey with ups and downs. What's on your mind about your little one? ðŸ’œ"
            ],
            help: [
                "I'm here to help in any way I can. What would be most supportive for you right now? ðŸ’œ",
                "Asking for help is a strength, not a weakness. What do you need support with today? ðŸ’œ",
                "I'm glad you reached out. Let's work through this together. What's going on? ðŸ’œ"
            ],
            sad: [
                "I'm sorry you're feeling sad. Your feelings are valid, and I'm here to listen. Would you like to share more? ðŸ’œ",
                "Sadness can feel heavy. Remember, it's okay to not be okay. What would bring you a little comfort right now? ðŸ’œ",
                "I'm holding space for your sadness, mama. You're not alone in this feeling. ðŸ’œ"
            ],
            lonely: [
                "Loneliness as a new mom is more common than people talk about. You're not alone in feeling this way. ðŸ’œ",
                "I hear you. Motherhood can feel isolating sometimes. Is there someone you could reach out to today? ðŸ’œ",
                "Feeling lonely is so hard. Remember, you have support here. What would help you feel more connected? ðŸ’œ"
            ],
            default: [
                "Thank you for sharing. I'm here to support you through this journey. ðŸ’œ",
                "I appreciate you opening up. How can I best support you today? ðŸ’œ",
                "I'm listening, mama. Whatever you're feeling is valid. ðŸ’œ",
                "Thanks for sharing that with me. Remember, I'm always here when you need to talk. ðŸ’œ",
                "I hear you. This motherhood journey has so many moments - both challenging and beautiful. I'm here for all of it. ðŸ’œ"
            ]
        };

        function getAIResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // Check for keywords and return appropriate response
            const keywordMap = [
                { keywords: ['tired', 'exhausted', 'fatigue', 'no energy', 'so tired'], category: 'tired' },
                { keywords: ['overwhelmed', 'too much', 'cant cope', "can't cope", 'drowning'], category: 'overwhelmed' },
                { keywords: ['stressed', 'stress', 'pressure', 'tense'], category: 'stressed' },
                { keywords: ['anxious', 'anxiety', 'worried', 'worry', 'nervous', 'panic'], category: 'anxious' },
                { keywords: ['happy', 'joy', 'joyful', 'wonderful', 'amazing', 'great day', 'fantastic'], category: 'happy' },
                { keywords: ['good', 'fine', 'okay', 'ok', 'better', 'well'], category: 'good' },
                { keywords: ['sleep', 'insomnia', 'awake', 'night', 'nap'], category: 'sleep' },
                { keywords: ['baby', 'newborn', 'infant', 'little one', 'child'], category: 'baby' },
                { keywords: ['help', 'support', 'advice', 'guidance', 'need'], category: 'help' },
                { keywords: ['sad', 'down', 'depressed', 'unhappy', 'crying', 'cry'], category: 'sad' },
                { keywords: ['lonely', 'alone', 'isolated', 'isolation'], category: 'lonely' }
            ];
            
            for (const item of keywordMap) {
                for (const keyword of item.keywords) {
                    if (message.includes(keyword)) {
                        const responses = aiResponses[item.category];
                        return responses[Math.floor(Math.random() * responses.length)];
                    }
                }
            }
            
            // Return random default response
            const defaults = aiResponses.default;
            return defaults[Math.floor(Math.random() * defaults.length)];
        }

        // ============================================
        // FEATURE 1: CONFETTI CELEBRATION
        // ============================================
        function triggerConfetti() {
            const colors = ['#9575CD', '#F8BBD0', '#F5EDE4', '#FFD54F', '#B8A5D9'];
            
            // Center burst
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: colors
            });

            // Left side
            setTimeout(() => {
                confetti({
                    particleCount: 50,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: colors
                });
            }, 200);

            // Right side
            setTimeout(() => {
                confetti({
                    particleCount: 50,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: colors
                });
            }, 400);
        }

        function showCelebrationToast(message) {
            // Remove any existing celebration toasts to prevent duplicates
            document.querySelectorAll('.toast.celebration').forEach(t => t.remove());
            
            const toast = document.createElement('div');
            toast.className = 'toast celebration';
            toast.textContent = message;
            toast.setAttribute('role', 'alert');
            document.body.appendChild(toast);

            // Add pulse to habits card
            const habitsCard = document.getElementById('todays-habits-card');
            if (habitsCard) {
                habitsCard.classList.add('celebration-pulse');
                setTimeout(() => habitsCard.classList.remove('celebration-pulse'), 600);
            }

            setTimeout(() => {
                toast.style.animation = 'toast-slide-up 0.4s var(--ease-smooth) reverse forwards';
                setTimeout(() => toast.remove(), 400);
            }, 4000);
        }

        // ============================================
        // FEATURE 2: COUNT-UP ANIMATION FOR STATS
        // ============================================
        function animateCountUp(element, target, suffix = '', duration = 800) {
            const start = 0;
            const startTime = performance.now();
            
            element.classList.add('counting');

            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function
                const easeOut = 1 - Math.pow(1 - progress, 3);
                const current = Math.floor(easeOut * target);
                
                element.textContent = current + suffix;
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                } else {
                    element.textContent = target + suffix;
                }
            }
            
            requestAnimationFrame(update);
        }

        function initStatsAnimation() {
            const statValues = document.querySelectorAll('.stat-value[data-target]');
            statValues.forEach(stat => {
                const target = parseInt(stat.dataset.target);
                const suffix = stat.dataset.suffix || '';
                animateCountUp(stat, target, suffix, 800);
            });
        }

        // ============================================
        // FEATURE 4: ENERGY-BASED SUGGESTIONS
        // ============================================
        function updateEnergySuggestion() {
            const energy = appState.energyLevel;
            const displayEl = document.getElementById('current-energy');
            const suggestionEl = document.getElementById('suggestion-text');
            
            let level, suggestion;
            
            if (energy <= 4) {
                level = `Low Energy (${energy}/10)`;
                suggestion = "Gentle day ahead - just hydrate, rest when baby rests, and breathe ðŸ’œ";
            } else if (energy <= 7) {
                level = `Medium Energy (${energy}/10)`;
                suggestion = "You've got steady energy! Try your stretch + a short walk ðŸŒ¿";
            } else {
                level = `High Energy (${energy}/10)`;
                suggestion = "Great energy today! Perfect for meal prep + extra movement ðŸ’ª";
            }
            
            if (displayEl) displayEl.textContent = level;
            if (suggestionEl) suggestionEl.textContent = suggestion;
        }

        // ============================================
        // FEATURE 5: QUICK WINS FUNCTIONALITY
        // ============================================
        function initQuickWins() {
            // Water Counter
            const waterBtn = document.getElementById('quick-water');
            const waterModal = document.getElementById('water-modal');
            const waterPlus = document.getElementById('water-plus');
            const waterMinus = document.getElementById('water-minus');
            const waterCount = document.getElementById('water-count');
            const waterClose = document.getElementById('water-close');
            const waterGlasses = document.querySelectorAll('.water-glass');

            waterBtn?.addEventListener('click', () => {
                waterModal.classList.add('active');
                updateWaterDisplay();
            });

            waterPlus?.addEventListener('click', () => {
                if (appState.waterCount < 8) {
                    appState.waterCount++;
                    updateWaterDisplay();
                    if (appState.waterCount === 8) {
                        showToast('ðŸŽ‰ Water goal complete!');
                    }
                }
            });

            waterMinus?.addEventListener('click', () => {
                if (appState.waterCount > 0) {
                    appState.waterCount--;
                    updateWaterDisplay();
                }
            });

            waterClose?.addEventListener('click', () => {
                waterModal.classList.remove('active');
            });

            function updateWaterDisplay() {
                if (waterCount) waterCount.textContent = appState.waterCount;
                waterGlasses.forEach((glass, i) => {
                    glass.classList.toggle('filled', i < appState.waterCount);
                });
            }

            // 2-Min Stretch Timer
            const stretchBtn = document.getElementById('quick-stretch');
            const timerOverlay = document.getElementById('timer-overlay');
            const timerDisplay = document.getElementById('timer-display');
            const timerClose = document.getElementById('timer-close');
            let timerInterval;

            stretchBtn?.addEventListener('click', () => {
                timerOverlay.classList.add('active');
                timerDisplay.classList.remove('alert');
                document.getElementById('timer-label').textContent = 'ðŸ§˜ Stretch Time';
                startTimer(120, timerDisplay, () => {
                    // Play happy toddler laughing sound
                    playSound('stretch-timer-sound');
                    timerDisplay.classList.add('alert');
                    document.getElementById('timer-label').textContent = 'Great job, mama! ðŸŽ‰';
                    setTimeout(() => {
                        timerOverlay.classList.remove('active');
                        timerDisplay.classList.remove('alert');
                    }, 3000);
                });
            });

            timerClose?.addEventListener('click', () => {
                clearInterval(timerInterval);
                timerOverlay.classList.remove('active');
                timerDisplay.classList.remove('alert');
            });

            function startTimer(seconds, display, onComplete) {
                let remaining = seconds;
                updateTimerDisplay(remaining, display);
                
                timerInterval = setInterval(() => {
                    remaining--;
                    updateTimerDisplay(remaining, display);
                    
                    if (remaining <= 0) {
                        clearInterval(timerInterval);
                        onComplete();
                    }
                }, 1000);
            }

            function updateTimerDisplay(seconds, display) {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                display.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            // Deep Breath Guide
            const breathBtn = document.getElementById('quick-breath');
            const breathingOverlay = document.getElementById('breathing-overlay');
            const breathingText = document.getElementById('breathing-text');
            const breathingTimer = document.getElementById('breathing-timer');
            const breathingClose = document.getElementById('breathing-close');
            let breathingInterval;

            breathBtn?.addEventListener('click', () => {
                breathingOverlay.classList.add('active');
                breathingTimer.classList.remove('alert');
                startBreathingGuide();
            });

            breathingClose?.addEventListener('click', () => {
                clearInterval(breathingInterval);
                breathingOverlay.classList.remove('active');
                breathingTimer.classList.remove('alert');
            });

            function startBreathingGuide() {
                let seconds = 30;
                const phases = ['Breathe In', 'Hold', 'Breathe Out', 'Hold'];
                let phaseIndex = 0;
                let phaseTimer = 4;
                
                breathingText.textContent = phases[0];
                updateTimerDisplay(seconds, breathingTimer);
                
                breathingInterval = setInterval(() => {
                    seconds--;
                    phaseTimer--;
                    
                    if (phaseTimer <= 0) {
                        phaseIndex = (phaseIndex + 1) % phases.length;
                        breathingText.textContent = phases[phaseIndex];
                        phaseTimer = 4;
                    }
                    
                    updateTimerDisplay(seconds, breathingTimer);
                    
                    if (seconds <= 0) {
                        clearInterval(breathingInterval);
                        // Play baby squealing sound
                        playSound('breath-timer-sound');
                        breathingTimer.classList.add('alert');
                        breathingText.textContent = 'You did it! ðŸ’œ';
                        setTimeout(() => {
                            breathingOverlay.classList.remove('active');
                            breathingTimer.classList.remove('alert');
                        }, 3000);
                    }
                }, 1000);
            }

            // Quick Note
            const noteBtn = document.getElementById('quick-note');
            const noteModal = document.getElementById('note-modal');
            const noteText = document.getElementById('quick-note-text');
            const noteCancel = document.getElementById('note-cancel');
            const noteSave = document.getElementById('note-save');

            noteBtn?.addEventListener('click', () => {
                noteModal.classList.add('active');
                noteText.focus();
            });

            noteCancel?.addEventListener('click', () => {
                noteModal.classList.remove('active');
                noteText.value = '';
            });

            noteSave?.addEventListener('click', () => {
                if (noteText.value.trim()) {
                    localStorage.setItem('quickNote_' + Date.now(), noteText.value);
                    showToast('ðŸ“ Note saved!');
                }
                noteModal.classList.remove('active');
                noteText.value = '';
            });

            // Check-in button
            const checkinBtn = document.getElementById('quick-checkin');
            checkinBtn?.addEventListener('click', () => {
                navigateToPage('levels');
            });
        }

        // ============================================
        // FEATURE 6 & 7: GRACE DAY SYSTEM
        // ============================================
        function initGraceDaySystem() {
            const graceBtn = document.getElementById('grace-day-btn');
            const graceModal = document.getElementById('grace-modal');
            const graceCancel = document.getElementById('grace-cancel');
            const graceConfirm = document.getElementById('grace-confirm');
            const graceRemaining = document.getElementById('grace-remaining');
            const graceBadge = document.getElementById('grace-badge');
            const graceCount = document.getElementById('grace-count');
            const graceProgress = document.getElementById('grace-progress');
            const streakShield = document.getElementById('streak-shield');
            const streakStat = document.getElementById('streak-stat');

            function updateGraceUI() {
                if (graceCount) graceCount.textContent = appState.graceDays;
                if (graceRemaining) graceRemaining.textContent = appState.graceDays;
                
                if (graceBtn) {
                    graceBtn.disabled = appState.graceDays <= 0;
                    graceBtn.textContent = appState.graceDays > 0 
                        ? `ðŸ›¡ï¸ Use Grace Day (${appState.graceDays} available)`
                        : 'ðŸ›¡ï¸ No Grace Days Available';
                }

                if (appState.streakProtected) {
                    streakShield.style.display = 'inline';
                    streakStat?.classList.add('streak-protected');
                } else {
                    streakShield.style.display = 'none';
                    streakStat?.classList.remove('streak-protected');
                }
            }

            graceBtn?.addEventListener('click', () => {
                if (appState.graceDays > 0) {
                    graceModal.classList.add('active');
                }
            });

            graceCancel?.addEventListener('click', () => {
                graceModal.classList.remove('active');
            });

            graceConfirm?.addEventListener('click', () => {
                appState.graceDays--;
                appState.streakProtected = true;
                updateGraceUI();
                graceModal.classList.remove('active');
                showToast('ðŸ›¡ï¸ Grace Day activated! Your streak is protected.');
            });

            updateGraceUI();
        }

        // ============================================
        // FEATURE 8: PHOTO UPLOAD
        // ============================================
        function initPhotoUpload() {
            const photoInput = document.getElementById('photo-input');
            const photoPreview = document.getElementById('photo-preview');

            // Load saved photo from localStorage
            const savedPhoto = localStorage.getItem('todaysMoment');
            if (savedPhoto) {
                displayPhoto(savedPhoto);
            }

            photoInput?.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const dataUrl = event.target.result;
                        localStorage.setItem('todaysMoment', dataUrl);
                        displayPhoto(dataUrl);
                        showToast('ðŸ“¸ Moment captured!');
                    };
                    reader.readAsDataURL(file);
                }
            });

            function displayPhoto(dataUrl) {
                photoPreview.innerHTML = `
                    <div class="photo-thumbnail-container">
                        <img src="${dataUrl}" alt="Today's moment" class="photo-thumbnail">
                        <button class="photo-remove-btn" type="button" aria-label="Remove photo" title="Remove photo">Ã—</button>
                    </div>
                `;
                
                // Add remove button functionality
                const removeBtn = photoPreview.querySelector('.photo-remove-btn');
                removeBtn?.addEventListener('click', removePhoto);
            }

            function removePhoto() {
                const container = photoPreview.querySelector('.photo-thumbnail-container');
                if (container) {
                    // Add fade-out animation
                    container.classList.add('removing');
                    setTimeout(() => {
                        localStorage.removeItem('todaysMoment');
                        photoInput.value = ''; // Clear the file input
                        photoPreview.innerHTML = '<span class="photo-placeholder">Capture a special moment from today</span>';
                        showToast('Photo removed');
                    }, 300);
                } else {
                    localStorage.removeItem('todaysMoment');
                    photoInput.value = '';
                    photoPreview.innerHTML = '<span class="photo-placeholder">Capture a special moment from today</span>';
                }
            }
        }

        // ============================================
        // FEATURE 10: SWIPE NAVIGATION
        // ============================================
        function initSwipeNavigation() {
            const mainContent = document.querySelector('.main-content');
            let startX, startY, distX, distY;
            let isSwiping = false;
            const threshold = 50;
            const restraint = 100;

            // Show swipe hints on first visit
            if (appState.firstVisit) {
                localStorage.setItem('visitedBefore', 'true');
                const leftHint = document.getElementById('swipe-left');
                const rightHint = document.getElementById('swipe-right');
                
                setTimeout(() => {
                    rightHint?.classList.add('show');
                    setTimeout(() => {
                        rightHint?.classList.remove('show');
                    }, 3000);
                }, 2000);
            }

            mainContent?.addEventListener('touchstart', (e) => {
                startX = e.touches[0].pageX;
                startY = e.touches[0].pageY;
                isSwiping = true;
            }, { passive: true });

            mainContent?.addEventListener('touchmove', (e) => {
                if (!isSwiping) return;
                
                distX = e.touches[0].pageX - startX;
                distY = e.touches[0].pageY - startY;
                
                // Visual feedback during swipe
                if (Math.abs(distX) > Math.abs(distY) && Math.abs(distX) > 20) {
                    const activePage = document.querySelector('.page.active');
                    if (activePage) {
                        activePage.classList.add('swiping');
                        activePage.style.transform = `translateX(${distX * 0.3}px)`;
                    }
                }
            }, { passive: true });

            mainContent?.addEventListener('touchend', (e) => {
                if (!isSwiping) return;
                isSwiping = false;

                const activePage = document.querySelector('.page.active');
                if (activePage) {
                    activePage.classList.remove('swiping');
                    activePage.style.transform = '';
                }

                // Check if it's a valid swipe
                if (Math.abs(distX) >= threshold && Math.abs(distY) <= restraint) {
                    if (distX < 0 && appState.currentPage < appState.pages.length - 1) {
                        // Swipe left - next page
                        navigateToPage(appState.pages[appState.currentPage + 1]);
                    } else if (distX > 0 && appState.currentPage > 0) {
                        // Swipe right - previous page
                        navigateToPage(appState.pages[appState.currentPage - 1]);
                    }
                }

                distX = 0;
                distY = 0;
            });
        }

        function navigateToPage(pageId) {
            const navItems = document.querySelectorAll('.nav-item');
            const pages = document.querySelectorAll('.page');
            
            appState.currentPage = appState.pages.indexOf(pageId);

            navItems.forEach(nav => {
                nav.classList.remove('active');
                nav.setAttribute('aria-current', 'false');
                if (nav.dataset.page === pageId) {
                    nav.classList.add('active');
                    nav.setAttribute('aria-current', 'page');
                }
            });

            pages.forEach(page => {
                page.classList.add('swipe-transition');
                if (page.id === pageId) {
                    page.classList.add('active');
                    page.setAttribute('aria-hidden', 'false');
                } else {
                    page.classList.remove('active');
                    page.setAttribute('aria-hidden', 'true');
                }
                setTimeout(() => page.classList.remove('swipe-transition'), 300);
            });

            // Trigger stats animation when insights page is shown
            if (pageId === 'insights') {
                initStatsAnimation();
            }

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ============================================
        // TOAST NOTIFICATIONS
        // ============================================
        function showToast(message, isCelebration = false) {
            const toast = document.createElement('div');
            toast.className = 'toast' + (isCelebration ? ' celebration' : '');
            toast.textContent = message;
            toast.setAttribute('role', 'alert');
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'toast-slide-up 0.4s var(--ease-smooth) reverse forwards';
                setTimeout(() => toast.remove(), 400);
            }, 3000);
        }

        // Instant toast - no delay before showing
        function showToastInstant(message) {
            // Remove any existing toasts first to prevent duplicates
            document.querySelectorAll('.toast:not(.celebration)').forEach(t => t.remove());
            
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            toast.setAttribute('role', 'alert');
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'toast-slide-up 0.4s var(--ease-smooth) reverse forwards';
                setTimeout(() => toast.remove(), 400);
            }, 2500);
        }

        // ============================================
        // MAIN INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item');
            const pages = document.querySelectorAll('.page');

            // ============================================
            // NAVIGATION FUNCTIONALITY
            // ============================================
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    navigateToPage(this.dataset.page);
                });
            });

            // Update date display
            const dateOptions = { weekday: 'long', month: 'long', day: 'numeric' };
            const today = new Date().toLocaleDateString('en-US', dateOptions);
            const dateElement = document.querySelector('#today-date');
            if (dateElement) {
                dateElement.textContent = today;
            }

            // ============================================
            // PARTICLE EFFECT
            // ============================================
            const particlesContainer = document.getElementById('particles');
            if (particlesContainer) {
                const particleCount = 15;
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 20 + 's';
                    particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                    particlesContainer.appendChild(particle);
                }
            }

            // ============================================
            // TODAY'S HABITS WITH CONFETTI
            // ============================================
            const todayHabits = document.querySelectorAll('.today-habit');
            const progressFill = document.getElementById('habits-progress');

            todayHabits.forEach(habit => {
                habit.addEventListener('click', function() {
                    const checkbox = this.querySelector('.habit-checkbox');
                    const wasCompleted = this.classList.contains('completed');
                    
                    this.classList.toggle('completed');
                    checkbox?.classList.toggle('checked');
                    checkbox?.setAttribute('aria-checked', !wasCompleted);
                    
                    // Update count
                    if (!wasCompleted) {
                        appState.completedHabits++;
                    } else {
                        appState.completedHabits--;
                        // Reset celebration flag when unchecking
                        appState.celebrationShown = false;
                    }
                    
                    // Update progress bar
                    const percent = (appState.completedHabits / appState.totalHabits) * 100;
                    if (progressFill) {
                        progressFill.style.width = percent + '%';
                    }
                    
                    // Check for all complete - only show once
                    if (appState.completedHabits === appState.totalHabits && !appState.celebrationShown) {
                        appState.celebrationShown = true;
                        // Play BOTH sounds simultaneously for celebration
                        playSound('all-complete-sound-1');
                        playSound('all-complete-sound-2');
                        triggerConfetti();
                        // Show ONLY celebration toast (not the regular one)
                        showCelebrationToast("ðŸŽ‰ All habits complete! You're amazing, mama!");
                    } else if (!wasCompleted && appState.completedHabits < appState.totalHabits) {
                        // Show regular toast only if not all habits complete
                        showToastInstant('Habit completed! ðŸŒŸ');
                    }
                });

                // Keyboard support
                habit.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.click();
                    }
                });
            });

            // ============================================
            // OTHER HABIT ITEMS (non-today)
            // ============================================
            const otherHabits = document.querySelectorAll('.placeholder-item[role="button"]:not(.today-habit)');
            otherHabits.forEach(item => {
                item.addEventListener('click', function() {
                    this.classList.toggle('completed');
                    showToast('Habit updated! ðŸŒŸ');
                });

                item.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.click();
                    }
                });
            });

            // ============================================
            // CHAT FUNCTIONALITY
            // ============================================
            const chatInput = document.querySelector('.chat-input-placeholder input');
            const chatButton = document.querySelector('.chat-input-placeholder button');
            
            if (chatInput && chatButton) {
                const sendMessage = () => {
                    const message = chatInput.value.trim();
                    if (message) {
                        const chatCard = chatInput.closest('.card');
                        const userBubble = document.createElement('div');
                        userBubble.className = 'chat-bubble user';
                        userBubble.textContent = message;
                        userBubble.setAttribute('role', 'article');
                        userBubble.setAttribute('aria-label', 'Your message');
                        chatInput.parentElement.before(userBubble);

                        chatInput.value = '';
                        showTypingIndicator(chatCard, message);
                    }
                };

                chatButton.addEventListener('click', sendMessage);
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }

            function showTypingIndicator(container, userMessage) {
                const indicator = document.createElement('div');
                indicator.className = 'typing-indicator';
                indicator.innerHTML = '<span></span><span></span><span></span>';
                container.querySelector('.chat-input-placeholder').before(indicator);

                // Get contextual AI response based on user message
                const aiResponse = getAIResponse(userMessage);

                setTimeout(() => {
                    indicator.remove();
                    const response = document.createElement('div');
                    response.className = 'chat-bubble';
                    response.textContent = aiResponse;
                    response.setAttribute('role', 'article');
                    response.setAttribute('aria-label', 'AI Coach message');
                    container.querySelector('.chat-input-placeholder').before(response);
                }, 1500);
            }

            // ============================================
            // INITIALIZE ALL FEATURES
            // ============================================
            initSoundSystem();
            initQuickWins();
            initGraceDaySystem();
            initPhotoUpload();
            initSwipeNavigation();
            updateEnergySuggestion();

            // Set initial aria-hidden
            pages.forEach(page => {
                if (!page.classList.contains('active')) {
                    page.setAttribute('aria-hidden', 'true');
                }
            });

            // Close modals on overlay click
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) {
                        overlay.classList.remove('active');
                    }
                });
            });

            // Close timer overlays on overlay click
            document.querySelectorAll('.timer-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) {
                        overlay.classList.remove('active');
                    }
                });
            });
        });
    </script>
</body>
</html>
